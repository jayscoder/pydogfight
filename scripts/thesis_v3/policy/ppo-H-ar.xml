<Root>
    <include path="{{filedir}}/policy/init.xml"/>
    <include path="{{filedir}}/policy/reward.xml"/>

    <!--    <ThesisPPOValue-->
    <!--            domain="control,default,attack,evade"-->
    <!--            path="{{filedir}}/{{filename}}/models/{{name}}"-->
    <!--            tensorboard_log="{{output_run_id}}/{{name}}/{{agent_name}}"-->
    <!--            log_interval="1"-->
    <!--            verbose="0"-->
    <!--            train="{{train}}"-->
    <!--    />-->

    <ReactiveSequence>
        <CanFireMissile/>
        <IsEnemyDetected/>
        <ThesisPPOCondition
                name="ThesisPPOCondition"
                domain="control,default,attack,evade"
                path="{{filedir}}/{{filename}}/models/{{name}}"
                tensorboard_log="{{output_run_id}}/{{name}}/{{agent_name}}"
                log_interval="1"
                verbose="0"
                train="{{train}}"
                n_steps="180"
        />
        <FireMissileAtNearestEnemy/>
    </ReactiveSequence>

    <ReactiveSelector>
        <include path="{{filedir}}/policy/handle_abnormal.xml"/>
        <Throttle duration="5 - episode // 200" time="{{time}}">
            <ThesisPPOSwitcherActionMask
                    name="ThesisPPOSwitcherActionMaskControl"
                    domain="control,default,attack,evade"
                    path="{{filedir}}/{{filename}}/models/{{name}}"
                    tensorboard_log="{{output_run_id}}/{{name}}/{{agent_name}}"
                    log_interval="1"
                    verbose="0"
                    train="{{train}}"
            >
                <Sequence>
                    <IsEnemyDetected/>
                    <PurePursueNearestEnemy/>
                </Sequence>
                <Sequence>
                    <IsMissileThreatDetected/>
                    <Manoeuvre39ToEvadeMissile turn_angle="90"/>
                </Sequence>
                <Sequence>
                    <IsMissileThreatDetected/>
                    <Manoeuvre39ToEvadeMissile turn_angle="-90"/>
                </Sequence>
                <Sequence>
                    <IsEnemyDetected/>
                    <Manoeuvre39ToEvadeEnemy turn_angle="90"/>
                </Sequence>
                <Sequence>
                    <IsEnemyDetected/>
                    <Manoeuvre39ToEvadeEnemy turn_angle="-90"/>
                </Sequence>
                <KeepFly/>
            </ThesisPPOSwitcherActionMask>
        </Throttle>
    </ReactiveSelector>
</Root>
